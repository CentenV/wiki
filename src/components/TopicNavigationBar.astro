---
import { Image } from "astro:assets";
import wikiLogo from "@assets/wikilogo.svg";
import type { ImageMetadata } from "astro";

const images = import.meta.glob<{ default: ImageMetadata }>("/src/assets/icons/*.{svg,jpeg,jpg,png,gif}", { eager: true });
console.log(images);
const topics = import.meta.glob("../pages/*/*.astro", { eager: true });
---

<nav class="flex flex-col overflow-hidden w-wiki-sidebar-full gap-3">
    <!-- <a href="/" class='flex' draggable={false}><img src={wikiLogo.src} alt="Wiki Logo" class="w-5/6 h-5/6" /></a> -->
    <a href="/" class="h-16" draggable={false}
        ><img src={wikiLogo.src} alt="Wiki Logo" class="h-full" /></a
    >
    <div
        class="flex flex-col gap-3 p-4 border rounded-wiki border-wiki border-wiki-hud-elements-color"
    >
        {
            Object.keys(topics).map((topicPageFile) => {
                const splitTopicPageUrl = topicPageFile.split("/");
                const topic = splitTopicPageUrl[2];
                const iconPath = `/src/assets/icons/${topic}.svg`
                if (!images[iconPath]) { throw new Error(`Icon "${iconPath}" for /${topic} not found`) }
                return (
                    <a href={`/${topic}`} class="flex flex-row gap-2">
                        <img src={images[iconPath].default.src} alt={"Icon"} class="invert" />
                        <div>
                            {topic[0].toUpperCase() +
                                topic.substring(1, topic.length)}
                        </div>
                    </a>
                );
            })
        }
    </div>
</nav>
